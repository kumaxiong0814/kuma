WITH Original AS
(
  SELECT
    *,
    DENSE_RANK() OVER (PARTITION BY CustomerPoNumber ORDER BY OrderSource) AS GroupRank
  FROM
  (
    SELECT
      '0174' AS InterfaceId,
      '0' AS ErrorClassification,
      CONVERT(VARCHAR(10), ROW_NUMBER() OVER (ORDER BY OrderSource)) AS OhiId,
      '0' AS Status,
      CONVERT(VARCHAR(10), ROW_NUMBER() OVER (ORDER BY OrderSource)) AS OrigSysDocumentRef,
      OrderSource,
      CustomerPoNumber,
      CustomerNumber,
      ShipmentPriorityCode,
      ShipToOrgCode,
      OrganizationCode,
      SecondaryInventoryName,
      CONVERT(VARCHAR(10), ROW_NUMBER() OVER (ORDER BY OrderSource)) AS OliId,
      OrigSysLineRef,
      InventoryItemSegment1,
      OrderedQuantity,
      InvoiceToOrgCode,
      '' AS ErrorMessage,
      '' AS SalesTableOIFRecId
    FROM earth_dp_SpoonsOrderIF_LS_IF_0174_TempWithSeq
  ) AS Subquery
)
SELECT
  InterfaceId,
  ErrorClassification,
  OhiId,
  Status,
  OrigSysDocumentRef,
  OrderSource,
  CustomerPoNumber,
  CustomerNumber,
  ShipmentPriorityCode,
  ShipToOrgCode,
  OrganizationCode,
  SecondaryInventoryName,
  OliId,
  OrigSysLineRef,
  InventoryItemSegment1,
  OrderedQuantity,
  InvoiceToOrgCode,
  ErrorMessage,
  SalesTableOIFRecId,
  GroupRank
FROM Original
ORDER BY CustomerPoNumber, GroupRank;
